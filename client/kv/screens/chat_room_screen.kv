#:import pd pandas
#:import asio asyncio

#===================================
# CHAT ROOM SCREEN
#===================================
<ChatRoomScreen>:
    on_enter: self.on_enter
    BoxLayout:
        orientation: 'vertical'
        text: 'CHATROOMSCREEN PLACEHOLDER'

        BoxLayout:
            id: chat_layout
#            height: 90
#            orientation: 'horizontal'
#            padding: 0
#            size_hint: (1, None)

            TextInput:
                id: message
                use_bubble: True
                write_tab: False
                on_text_validate: app.root.client_protocol.send_message(message.text)

            Button:
                text: 'Send'
                on_press: app.root.client_protocol.send_message(message.text)
                size_hint: (0.3, 1)

            TextInput:
                background_color: (0,0,0,1)
                foreground_color: (1,1,1,1)
                size_hint_y: 1
        #        height: self.texture_size[1]
                text_size: self.width, None
                use_bubble: True
                text: root.chat_history
                readonly: True

#            ScrollableLabel:
#                id: chat_logs
#                text: 'fiddle stix' if root.parent is None else root.chat_history

            ScrollView:
                id: user_list_container

                BoxLayout:
                    orientation: 'vertical'
                    id: user_list




<ScrollableLabel@ScrollView>:
    text: 'SCROLLABLELABEL'
#    Label:
#        size_hint_y: None
#        height: self.texture_size[1]
#        text_size: self.width, None
#        text: root.text
    TextInput:
        size_hint_y: 1
#        height: self.texture_size[1]
        text_size: self.width, None
        use_bubble: True
        text: root.text
#        readonly: True

<ChatLabel@Label>:
    text: 'PLACEHOLDER'

<ContextMenu@BoxLayout>:
    id: context_menu
    orientation: 'vertical'

    Button:
        id: private_message
        text: "Send private message"
        on_press: app.root.ids.chat_room_screen.next_message_private(context_menu.parent.name)
        on_press: self.parent.parent.dismiss()

    Button:
        id: ignore
        text: "Toggle ignore"
        on_press: app.root.client_protocol.toggle_user_ignore(context_menu.parent.name)
        on_press: self.parent.parent.dismiss()

<PopModal@ModalView>:
    size_hint: None, None
    height: '50dp'
    width: '200dp'
#    pos_hint_x: 0 if self.touch is None else self.touch.spos[0]
#    pos_hint_y: 0 if self.touch is None else self.touch.spos[1]

<ModalPopupButton@Button>:



